import{c as z,r as l,_ as q,j as e,q as ie,G as B,$ as le,b as ce,C as de,f as ue,a0 as me,T as he,D as xe,Z as Y,v as fe,O as ge,a1 as pe,h as g,A as G,n as je,L as P,B as _,a2 as H,a3 as ve,t as f,a4 as U,k as ye,i as Ae,s as V,a5 as De}from"./index-D6PnLut5.js";import{o as Ne,s as C,n as $,C as T,e as F,b as O,c as M,d as L,u as Se,a as _e,L as Ce,F as we,f as v,g as y,h as A,i as D,q as N,j as S,I as be}from"./form-Cx57qBNX.js";import{B as Ee,s as Re,S as w,a as b,b as E,c as R,d as k}from"./select-Ma3QgqIm.js";import{M as ke}from"./mail-DQt94Mam.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Te=z("external-link",Pe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ie=z("refresh-cw",Fe),Oe=Ne({base_currency:C().length(3,"Currency code must be 3 characters"),timezone:C().min(1,"Timezone is required"),locale:C().min(1,"Locale is required"),first_day_of_week:$().min(0).max(6),first_day_of_month:$().min(1).max(28),number_format:C().min(1,"Number format is required")});var W="AlertDialog",[Me]=ce(W,[q]),x=q(),J=a=>{const{__scopeAlertDialog:s,...n}=a,o=x(s);return e.jsx(ie,{...o,...n,modal:!0})};J.displayName=W;var Le="AlertDialogTrigger",Ue=l.forwardRef((a,s)=>{const{__scopeAlertDialog:n,...o}=a,i=x(n);return e.jsx(pe,{...i,...o,ref:s})});Ue.displayName=Le;var Ve="AlertDialogPortal",K=a=>{const{__scopeAlertDialog:s,...n}=a,o=x(s);return e.jsx(fe,{...o,...n})};K.displayName=Ve;var $e="AlertDialogOverlay",Z=l.forwardRef((a,s)=>{const{__scopeAlertDialog:n,...o}=a,i=x(n);return e.jsx(ge,{...i,...o,ref:s})});Z.displayName=$e;var j="AlertDialogContent",[ze,qe]=Me(j),Be=me("AlertDialogContent"),Q=l.forwardRef((a,s)=>{const{__scopeAlertDialog:n,children:o,...i}=a,d=x(n),h=l.useRef(null),c=B(s,h),p=l.useRef(null);return e.jsx(le,{contentName:j,titleName:X,docsSlug:"alert-dialog",children:e.jsx(ze,{scope:n,cancelRef:p,children:e.jsxs(de,{role:"alertdialog",...d,...i,ref:c,onOpenAutoFocus:ue(i.onOpenAutoFocus,m=>{m.preventDefault(),p.current?.focus({preventScroll:!0})}),onPointerDownOutside:m=>m.preventDefault(),onInteractOutside:m=>m.preventDefault(),children:[e.jsx(Be,{children:o}),e.jsx(Ge,{contentRef:h})]})})})});Q.displayName=j;var X="AlertDialogTitle",ee=l.forwardRef((a,s)=>{const{__scopeAlertDialog:n,...o}=a,i=x(n);return e.jsx(he,{...i,...o,ref:s})});ee.displayName=X;var ae="AlertDialogDescription",se=l.forwardRef((a,s)=>{const{__scopeAlertDialog:n,...o}=a,i=x(n);return e.jsx(xe,{...i,...o,ref:s})});se.displayName=ae;var Ye="AlertDialogAction",te=l.forwardRef((a,s)=>{const{__scopeAlertDialog:n,...o}=a,i=x(n);return e.jsx(Y,{...i,...o,ref:s})});te.displayName=Ye;var re="AlertDialogCancel",ne=l.forwardRef((a,s)=>{const{__scopeAlertDialog:n,...o}=a,{cancelRef:i}=qe(re,n),d=x(n),h=B(s,i);return e.jsx(Y,{...d,...o,ref:h})});ne.displayName=re;var Ge=({contentRef:a})=>{const s=`\`${j}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${j}\` by passing a \`${ae}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${j}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return l.useEffect(()=>{document.getElementById(a.current?.getAttribute("aria-describedby"))||console.warn(s)},[s,a]),null},He=J,We=K,Je=Z,Ke=Q,Ze=te,Qe=ne,Xe=ee,ea=se;function aa({...a}){return e.jsx(He,{"data-slot":"alert-dialog",...a})}function sa({...a}){return e.jsx(We,{"data-slot":"alert-dialog-portal",...a})}function ta({className:a,...s}){return e.jsx(Je,{"data-slot":"alert-dialog-overlay",className:g("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...s})}function ra({className:a,...s}){return e.jsxs(sa,{children:[e.jsx(ta,{}),e.jsx(Ke,{"data-slot":"alert-dialog-content",className:g("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...s})]})}function na({className:a,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:g("flex flex-col gap-2 text-center sm:text-left",a),...s})}function oa({className:a,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:g("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...s})}function ia({className:a,...s}){return e.jsx(Xe,{"data-slot":"alert-dialog-title",className:g("text-lg font-semibold",a),...s})}function la({className:a,...s}){return e.jsx(ea,{"data-slot":"alert-dialog-description",className:g("text-muted-foreground text-sm",a),...s})}function ca({className:a,...s}){return e.jsx(Ze,{className:g(G(),a),...s})}function da({className:a,...s}){return e.jsx(Qe,{className:g(G({variant:"outline"}),a),...s})}function ua(){const[a,s]=l.useState(!1),[n,o]=l.useState(!0),[i,d]=l.useState(null),[h,c]=l.useState(!1),[p,m]=l.useState(!1);l.useEffect(()=>{I()},[]);const I=async()=>{o(!0);try{const u=await je();s(u.isAuthenticated),d(u.user||null)}catch(u){console.error("Error checking Splitwise connection:",u)}finally{o(!1)}},r=async()=>{try{await ve()}catch(u){f.error("Failed to connect",{description:u.message})}},t=async()=>{m(!0);try{const u=await Re.getCurrentUser();d(u),f.success("Refreshed Splitwise data")}catch(u){u.message==="UNAUTHORIZED"?(f.error("Session expired",{description:"Please reconnect your Splitwise account"}),await U(),s(!1),d(null)):f.error("Failed to refresh",{description:u.message})}finally{m(!1)}},oe=async()=>{await U(),s(!1),d(null),c(!1),f.info("Disconnected from Splitwise")};return n?e.jsx(T,{children:e.jsx(F,{className:"p-6 flex items-center justify-center",children:e.jsx(P,{className:"h-6 w-6 animate-spin text-muted-foreground"})})}):e.jsxs(e.Fragment,{children:[e.jsxs(T,{children:[e.jsx(O,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs(M,{className:"flex items-center gap-2",children:["Splitwise Integration",a&&e.jsx(Ee,{variant:"secondary",className:"bg-green-500/10 text-green-700 dark:text-green-400",children:"Connected"})]}),e.jsx(L,{children:a?"View and track your shared expenses":"Connect to import your Splitwise expenses"})]})})}),e.jsx(F,{className:"space-y-4",children:a?e.jsxs(e.Fragment,{children:[i&&e.jsx("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[i.first_name," ",i.last_name]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.email})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{onClick:t,disabled:p,variant:"outline",size:"sm",children:p?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Refresh"]})}),e.jsxs(_,{onClick:()=>c(!0),variant:"outline",size:"sm",className:"text-destructive hover:text-destructive",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Disconnect"]})]})]}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-lg border border-dashed p-4 text-center",children:e.jsxs(_,{onClick:r,className:"w-full sm:w-auto",children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Connect Splitwise"]})})})})]}),e.jsx(aa,{open:h,onOpenChange:c,children:e.jsxs(ra,{children:[e.jsxs(na,{children:[e.jsx(ia,{children:"Disconnect Splitwise?"}),e.jsx(la,{children:"This will remove your Splitwise connection and clear stored tokens. You can reconnect anytime."})]}),e.jsxs(oa,{children:[e.jsx(da,{children:"Cancel"}),e.jsx(ca,{onClick:oe,className:"bg-destructive text-destructive-foreground",children:"Disconnect"})]})]})})]})}const ma=[{code:"USD",name:"US Dollar"},{code:"EUR",name:"Euro"},{code:"GBP",name:"British Pound"},{code:"INR",name:"Indian Rupee"},{code:"JPY",name:"Japanese Yen"},{code:"AUD",name:"Australian Dollar"},{code:"CAD",name:"Canadian Dollar"}],ha=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Paris","Asia/Tokyo","Asia/Kolkata","Australia/Sydney"],xa=[{code:"en-US",name:"English (US)"},{code:"en-GB",name:"English (UK)"},{code:"en-IN",name:"English (India)"},{code:"de-DE",name:"German"},{code:"fr-FR",name:"French"},{code:"es-ES",name:"Spanish"},{code:"ja-JP",name:"Japanese"}],fa=[{value:0,name:"Sunday"},{value:1,name:"Monday"},{value:2,name:"Tuesday"},{value:3,name:"Wednesday"},{value:4,name:"Thursday"},{value:5,name:"Friday"},{value:6,name:"Saturday"}];function ya(){const{user:a,signOut:s}=ye(),n=Ae(),[o,i]=l.useState(!0),[d,h]=l.useState(!1),c=Se({resolver:_e(Oe),defaultValues:{base_currency:"INR",timezone:"UTC",locale:"en-US",first_day_of_week:0,first_day_of_month:1,number_format:"en-US"}});l.useEffect(()=>{p()},[a]);const p=async()=>{if(a)try{const{data:r,error:t}=await V.from("profiles").select("*").eq("user_id",a.id).single();if(t&&t.code!=="PGRST116")throw t;r&&c.reset({base_currency:r.base_currency,timezone:r.timezone,locale:r.locale,first_day_of_week:r.first_day_of_week,first_day_of_month:r.first_day_of_month,number_format:r.number_format})}catch(r){console.error("Error loading profile:",r),f.error("Failed to load profile",{description:r.message})}finally{i(!1)}},m=async r=>{if(a){h(!0);try{const{error:t}=await V.from("profiles").upsert({user_id:a.id,...r,updated_at:new Date().toISOString()},{onConflict:"user_id"});if(t)throw t;f.success("Profile updated",{description:"Your settings have been saved"})}catch(t){console.error("Error saving profile:",t),f.error("Failed to save profile",{description:t.message})}finally{h(!1)}}},I=async()=>{await s(),n("/auth")};return o?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(P,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6 max-w-3xl",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Profile Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account settings and preferences"})]}),e.jsxs(T,{children:[e.jsxs(O,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5"}),"Account Information"]}),e.jsx(L,{children:"Your account details and authentication status"})]}),e.jsxs(F,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted rounded-lg",children:[e.jsx(ke,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(Ce,{className:"text-sm text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium",children:a?.email})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(ua,{})}),e.jsxs(_,{onClick:I,variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Sign Out"]})]})]}),e.jsxs(T,{children:[e.jsxs(O,{children:[e.jsx(M,{children:"Preferences"}),e.jsx(L,{children:"Customize your app experience"})]}),e.jsx(F,{children:e.jsx(we,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(m),className:"space-y-6",children:[e.jsx(v,{control:c.control,name:"base_currency",render:({field:r})=>e.jsxs(y,{children:[e.jsx(A,{children:"Base Currency"}),e.jsxs(w,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(D,{children:e.jsx(b,{children:e.jsx(E,{placeholder:"Select currency"})})}),e.jsx(R,{children:ma.map(t=>e.jsxs(k,{value:t.code,children:[t.code," -"," ",t.name]},t.code))})]}),e.jsx(N,{children:"Your primary currency for reporting"}),e.jsx(S,{})]})}),e.jsx(v,{control:c.control,name:"timezone",render:({field:r})=>e.jsxs(y,{children:[e.jsx(A,{children:"Timezone"}),e.jsxs(w,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(D,{children:e.jsx(b,{children:e.jsx(E,{placeholder:"Select timezone"})})}),e.jsx(R,{children:ha.map(t=>e.jsx(k,{value:t,children:t},t))})]}),e.jsx(N,{children:"Used for scheduling and date display"}),e.jsx(S,{})]})}),e.jsx(v,{control:c.control,name:"locale",render:({field:r})=>e.jsxs(y,{children:[e.jsx(A,{children:"Language & Region"}),e.jsxs(w,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(D,{children:e.jsx(b,{children:e.jsx(E,{placeholder:"Select locale"})})}),e.jsx(R,{children:xa.map(t=>e.jsx(k,{value:t.code,children:t.name},t.code))})]}),e.jsx(N,{children:"Affects date and number formatting"}),e.jsx(S,{})]})}),e.jsx(v,{control:c.control,name:"first_day_of_week",render:({field:r})=>e.jsxs(y,{children:[e.jsx(A,{children:"First Day of Week"}),e.jsxs(w,{onValueChange:t=>r.onChange(parseInt(t)),defaultValue:r.value.toString(),children:[e.jsx(D,{children:e.jsx(b,{children:e.jsx(E,{placeholder:"Select day"})})}),e.jsx(R,{children:fa.map(t=>e.jsx(k,{value:t.value.toString(),children:t.name},t.value))})]}),e.jsx(N,{children:"Used in calendar and reports"}),e.jsx(S,{})]})}),e.jsx(v,{control:c.control,name:"first_day_of_month",render:({field:r})=>e.jsxs(y,{children:[e.jsx(A,{children:"First Day of Month"}),e.jsx(D,{children:e.jsx(be,{type:"number",min:1,max:28,...r,onChange:t=>r.onChange(parseInt(t.target.value))})}),e.jsx(N,{children:"For monthly budget cycles (1-28)"}),e.jsx(S,{})]})}),e.jsxs(_,{type:"submit",className:"w-full sm:w-auto",disabled:d,children:[d&&e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),d?"Saving...":"Save Changes"]})]})})})]})]})}export{ya as default};
