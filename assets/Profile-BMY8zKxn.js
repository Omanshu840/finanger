import{k as V,i as R,r as p,s as S,t as y,j as e,Z as z,B as v,_ as M}from"./index-MHHjkg74.js";import{o as O,s as m,n as C,u as Y,a as B,L as b,C as N,b as w,c as E,d as F,e as A,q,F as G,f as o,g as t,h as i,i as l,r as c,j as d,I as J}from"./form-BPYWxcje.js";import{S as u,a as h,b as x,c as j,d as f}from"./select-Chbdabbr.js";import{M as K}from"./mail-94q0e4RH.js";const W=O({base_currency:m().length(3,"Currency code must be 3 characters"),timezone:m().min(1,"Timezone is required"),locale:m().min(1,"Locale is required"),first_day_of_week:C().min(0).max(6),first_day_of_month:C().min(1).max(28),number_format:m().min(1,"Number format is required")}),Z=[{code:"USD",name:"US Dollar"},{code:"EUR",name:"Euro"},{code:"GBP",name:"British Pound"},{code:"INR",name:"Indian Rupee"},{code:"JPY",name:"Japanese Yen"},{code:"AUD",name:"Australian Dollar"},{code:"CAD",name:"Canadian Dollar"}],H=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Paris","Asia/Tokyo","Asia/Kolkata","Australia/Sydney"],Q=[{code:"en-US",name:"English (US)"},{code:"en-GB",name:"English (UK)"},{code:"en-IN",name:"English (India)"},{code:"de-DE",name:"German"},{code:"fr-FR",name:"French"},{code:"es-ES",name:"Spanish"},{code:"ja-JP",name:"Japanese"}],X=[{value:0,name:"Sunday"},{value:1,name:"Monday"},{value:2,name:"Tuesday"},{value:3,name:"Wednesday"},{value:4,name:"Thursday"},{value:5,name:"Friday"},{value:6,name:"Saturday"}];function re(){const{user:n,signOut:U}=V(),D=R(),[I,k]=p.useState(!0),[g,_]=p.useState(!1),r=Y({resolver:B(W),defaultValues:{base_currency:"USD",timezone:"UTC",locale:"en-US",first_day_of_week:0,first_day_of_month:1,number_format:"en-US"}});p.useEffect(()=>{L()},[n]);const L=async()=>{if(n)try{const{data:s,error:a}=await S.from("profiles").select("*").eq("user_id",n.id).single();if(a&&a.code!=="PGRST116")throw a;s&&r.reset({base_currency:s.base_currency,timezone:s.timezone,locale:s.locale,first_day_of_week:s.first_day_of_week,first_day_of_month:s.first_day_of_month,number_format:s.number_format})}catch(s){console.error("Error loading profile:",s),y.error("Failed to load profile",{description:s.message})}finally{k(!1)}},P=async s=>{if(n){_(!0);try{const{error:a}=await S.from("profiles").upsert({user_id:n.id,...s,updated_at:new Date().toISOString()},{onConflict:"user_id"});if(a)throw a;y.success("Profile updated",{description:"Your settings have been saved"})}catch(a){console.error("Error saving profile:",a),y.error("Failed to save profile",{description:a.message})}finally{_(!1)}}},T=async()=>{await U(),D("/auth")};return I?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(b,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6 max-w-3xl",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Profile Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account settings and preferences"})]}),e.jsxs(N,{children:[e.jsxs(w,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Account Information"]}),e.jsx(F,{children:"Your account details and authentication status"})]}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-muted rounded-lg",children:[e.jsx(K,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(q,{className:"text-sm text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium",children:n?.email})]})]}),e.jsxs(v,{onClick:T,variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Sign Out"]})]})]}),e.jsxs(N,{children:[e.jsxs(w,{children:[e.jsx(E,{children:"Preferences"}),e.jsx(F,{children:"Customize your app experience"})]}),e.jsx(A,{children:e.jsx(G,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(P),className:"space-y-6",children:[e.jsx(o,{control:r.control,name:"base_currency",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Base Currency"}),e.jsxs(u,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(l,{children:e.jsx(h,{children:e.jsx(x,{placeholder:"Select currency"})})}),e.jsx(j,{children:Z.map(a=>e.jsxs(f,{value:a.code,children:[a.code," - ",a.name]},a.code))})]}),e.jsx(c,{children:"Your primary currency for reporting"}),e.jsx(d,{})]})}),e.jsx(o,{control:r.control,name:"timezone",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Timezone"}),e.jsxs(u,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(l,{children:e.jsx(h,{children:e.jsx(x,{placeholder:"Select timezone"})})}),e.jsx(j,{children:H.map(a=>e.jsx(f,{value:a,children:a},a))})]}),e.jsx(c,{children:"Used for scheduling and date display"}),e.jsx(d,{})]})}),e.jsx(o,{control:r.control,name:"locale",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"Language & Region"}),e.jsxs(u,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(l,{children:e.jsx(h,{children:e.jsx(x,{placeholder:"Select locale"})})}),e.jsx(j,{children:Q.map(a=>e.jsx(f,{value:a.code,children:a.name},a.code))})]}),e.jsx(c,{children:"Affects date and number formatting"}),e.jsx(d,{})]})}),e.jsx(o,{control:r.control,name:"first_day_of_week",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"First Day of Week"}),e.jsxs(u,{onValueChange:a=>s.onChange(parseInt(a)),defaultValue:s.value.toString(),children:[e.jsx(l,{children:e.jsx(h,{children:e.jsx(x,{placeholder:"Select day"})})}),e.jsx(j,{children:X.map(a=>e.jsx(f,{value:a.value.toString(),children:a.name},a.value))})]}),e.jsx(c,{children:"Used in calendar and reports"}),e.jsx(d,{})]})}),e.jsx(o,{control:r.control,name:"first_day_of_month",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{children:"First Day of Month"}),e.jsx(l,{children:e.jsx(J,{type:"number",min:1,max:28,...s,onChange:a=>s.onChange(parseInt(a.target.value))})}),e.jsx(c,{children:"For monthly budget cycles (1-28)"}),e.jsx(d,{})]})}),e.jsxs(v,{type:"submit",className:"w-full sm:w-auto",disabled:g,children:[g&&e.jsx(b,{className:"mr-2 h-4 w-4 animate-spin"}),g?"Saving...":"Save Changes"]})]})})})]})]})}export{re as default};
