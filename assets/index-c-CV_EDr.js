import{c as d,ag as u,ah as g,ai as f,aj as p,j as h,af as l,d as w,ak as m}from"./index-4zS9zYSY.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],x=d("check",v);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],q=d("chevron-down",b),y="https://corsproxy.io/https://secure.splitwise.com/api/v3.0";class S{async getAccessToken(){return(await u())?.access_token||null}async request(e,t){const n=await this.getAccessToken();if(!n)throw new Error("Not authenticated with Splitwise");const r=`${y}${e}`,s=await fetch(r,{...t,headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json",...t?.headers}});if(s.status===401)throw new Error("UNAUTHORIZED");if(!s.ok){const i=await s.text();console.error("API Error:",i);try{const o=JSON.parse(i);throw new Error(o.error||o.message||`HTTP ${s.status}`)}catch{throw new Error(`HTTP ${s.status}: ${i}`)}}return s.json()}async getCurrentUser(e=!1){if(!e){const r=await g();if(r)return console.log("âœ… Using cached user:",r.first_name),r}console.log("ðŸ“¥ Fetching current user from API");const t=await this.request("/get_current_user");await f({id:t.user.id,email:t.user.email,first_name:t.user.first_name,last_name:t.user.last_name});const n=await u();return n&&await p({...n,user:t.user}),t.user}async getGroups(){return(await this.request("/get_groups")).groups}async getGroup(e){return(await this.request(`/get_group/${e}`)).group}async getFriends(){return(await this.request("/get_friends")).friends}async getFriend(e){return(await this.request(`/get_friend/${e}`)).friend}async getCurrencies(){return(await this.request("/get_currencies")).currencies}async getCategories(){return(await this.request("/get_categories")).categories}async createExpense(e){const t={cost:e.cost,description:e.description,currency_code:e.currency_code||"USD",date:e.date||new Date().toISOString()};e.details&&(t.details=e.details),e.group_id!==void 0&&(t.group_id=e.group_id),e.category_id&&(t.category_id=e.category_id),e.repeat_interval&&(t.repeat_interval=e.repeat_interval),e.split_equally&&(t.split_equally=!0),e.users&&e.users.length>0&&e.users.forEach((r,s)=>{r.user_id?t[`users__${s}__user_id`]=r.user_id:(r.email&&(t[`users__${s}__email`]=r.email),r.first_name&&(t[`users__${s}__first_name`]=r.first_name),r.last_name&&(t[`users__${s}__last_name`]=r.last_name)),t[`users__${s}__paid_share`]=r.paid_share,t[`users__${s}__owed_share`]=r.owed_share});const n=await this.request("/create_expense",{method:"POST",body:JSON.stringify(t)});return{expense:n.expenses[0],errors:n.errors}}async getRecentExpenses(e=20){const t=await this.request(`/get_expenses?limit=${e}`),n=await this.getCurrentUser();return t.expenses.map(r=>{const s=r.users.find(_=>_.user_id===n.id),i=parseFloat(s?.owed_share||"0"),c=parseFloat(s?.paid_share||"0")-i;return{id:r.id,date:r.date,description:r.description,group:r.group_id?`Group ${r.group_id}`:"Personal",user_share_amount:Math.abs(c),currency:r.currency_code,settled:c===0,category:r.category?.name}})}async getExpenses(e){const t=new URLSearchParams;e.dated_after&&t.append("dated_after",e.dated_after),e.dated_before&&t.append("dated_before",e.dated_before),e.limit&&t.append("limit",e.limit.toString()),e.offset&&t.append("offset",e.offset.toString());const n=t.toString(),r=n?`/get_expenses?${n}`:"/get_expenses";return this.request(r)}}const C=new S,k=m("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function E({className:a,variant:e,asChild:t=!1,...n}){const r=t?l:"span";return h.jsx(r,{"data-slot":"badge",className:w(k({variant:e}),a),...n})}function T(a,[e,t]){return Math.min(t,Math.max(e,a))}export{E as B,x as C,q as a,T as c,C as s};
